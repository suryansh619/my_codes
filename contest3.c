#include <stdio.h>
int main()
{
	int n,q,i;
	scanf("%d%d",&n,&q);
	long long int a[100001]={0},ev[100001]={0},od[100001]={0},e=0,o=0,x;
	for(i=0;i<n;i++)
	{
		scanf("%lld",&a[i]);
		if(a[i]%2==0)
			{
				if(a[i]>=e)
				{
					e=a[i];
					ev[i]=e;
					od[i]=o;
				}
				else{
				ev[i]=e;
					od[i]=o;}
			}
		else
		{
			if(a[i]>=o)
				{
					o=a[i];
					od[i]=o;
					ev[i]=e;
				}
				else
				{
					ev[i]=e;
					od[i]=o;
				}
		}	
	}
	while(q--)
	{
		int l,r,b;
		scanf("%d",&b);if(a[r]%2==0)
			{
				i=r;
				while(a[r]>=ev[i])
				{
					ev[i]=a[r];
					i++;
				}
			}
		if(b==1)
		{
			scanf("%d%lld",&r,&x);
			r=r-1;
			a[r]=x;
			if(a[r]%2==0)
			{
				i=r;
				while(a[r]>=ev[i])
				{
					ev[i]=a[r];
					i++;
				}
			}
			else
			{
				i=r;
				while(a[r]>=od[i])
				{
					od[i]=a[r];
					i++;
				}
			}
		}
		else
		{
			scanf("%d%d",&l,&r);
			l=l-1;
			r=r-1;
			if(l==r)
			{
				if(l==2)
					{if(a[l]%2==0)
						printf("%lld\n",a[l]);
					else
						printf("DNE\n");
			        }
			    else
			        {if(a[l]%2!=0)
						printf("%lld\n",a[l]);
					else
						printf("DNE\n");
			        }
			continue;
			}        
		if(b==2)
			printf("%lld\n",ev[r]);
		else
            printf("%lld\n",od[r]);
         		
		}
	}
return 0;
}